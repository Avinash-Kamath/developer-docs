---
title: Quickstart
sidebar:
  label: "Quickstart"
tableOfContents: true
next:
  label: "Manage users"
  link: "/docs/fsa/manage-users"
head:
  - tag: style
    content: |
      .sl-markdown-content h2 {
        font-size: var(--sl-text-xl);
      }
---

import { Card, CardGrid, Steps, TabItem, Tabs, Aside } from '@astrojs/starlight/components';
import CheckItem from '@/components/ui/CheckItem.astro';
import InstallSDK from '@components/templates/_installsdk.mdx'

Learn how to integrate Scalekit into your project to implement secure, enterprise-grade authentication.

<div>
   Before you begin
  <CheckItem iconName="forward-slash">
     [Set up your Scalekit account](https://app.scalekit.com/ws/signup)
  </CheckItem>
  <CheckItem iconName="github">
     [Clone the quickstart repository in express](https://github.com/scalekit-developers/nodejs-example-apps/tree/main/expressjs-loginbox-authn)
  </CheckItem>
</div>

Let's get started!

<Steps>
 1. ## Install the Scalekit SDK

    <InstallSDK />

    Copy your API credentials from the Scalekit dashboard's API Config section and set them as environment variables.
    ```bash
    SCALEKIT_ENVIRONMENT_URL='<YOUR_ENVIRONMENT_URL>'
    SCALEKIT_CLIENT_ID='<ENVIRONMENT_CLIENT_ID>'
    SCALEKIT_CLIENT_SECRET='<ENVIRONMENT_CLIENT_SECRET>'
    ```

    Create a new Scalekit client instance after initializing the environment variables.
    <Tabs syncKey="tech-stack">
      <TabItem value="nodejs" label="Node.js">
      ```javascript title="utils/auth.js"
      import { Scalekit } from '@scalekit-sdk/node';

      export let scalekit = new Scalekit(
        process.env.SCALEKIT_ENVIRONMENT_URL,
        process.env.SCALEKIT_CLIENT_ID,
        process.env.SCALEKIT_CLIENT_SECRET
      );
      ```
      </TabItem>
    </Tabs>
  2. ## Redirect the user to the authentication page
       Generate the authorization URL by passing a [registered](/reference/fsa/redirects) _callback URL_ and _scopes_ to the Scalekit SDK.
        <Tabs>
        <TabItem value="node" label="Node.js">
        ```javascript title="Express.js" wrap "authorizationUrl" ins={3,4} {"Redirect user to Scalekit's authentication page":8}
        const redirectUri = 'http://localhost:3000/api/callback';
        const options = {
          scopes: ['openid', 'profile', 'email', 'offline_access'],
          prompt: 'create',
        };

         const authorizationUrl = scalekit.getAuthorizationUrl(redirectUri, options);

         res.redirect(authorizationUrl);
        ```
        </TabItem>
      </Tabs>

     This will redirect the user to Scalekit's managed sign-in page.

3. ## Allow users to sign in or sign up
      Users can now sign in or sign up using their [preferred authentication methods](/guides/fsa/auth-methods). Each authentication method is managed by Scalekit to successfully verify the user's identity.

      ![](@/assets/docs/fsa/quickstart/1.png)

4. ## Retrieve user profile after identity verification
      Scalekit triggers a callback to your registered _callback URL_ with an authorization code. Exchange the code to get the user's profile information.

      <Tabs syncKey="tech-stack">
        <TabItem value="node" label="Node.js">
        ```javascript collapse={22-26}
        import scalekit from '@/utils/auth.js'
        const redirectUri = 'http://localhost:3000/api/callback';

        // Get the authorization code from the scalekit initiated callback
        app.get('/api/callback', async (req, res) => {
          const { code, error, error_description } = req.query;

          if (error) {
            return res.status(401).json({ error, error_description });
          }

          try {
            // Exchange the authorization code for a user profile
            const authResult = await scalekit.authenticateWithCode(
              code, redirectUri
            );

            const { user } = authResult;

            // "user" object contains the user's profile information
            // Next step: Create a session and log in the user
            res.redirect('/dashboard/profile');
          } catch (err) {
            console.error('Error exchanging code:', err);
            res.status(500).json({ error: 'Failed to authenticate user' });
          }
        });
        ```
        </TabItem>
      </Tabs>

      The `authenticateWithCode` method returns an object containing the user's profile information (`user` object) and `idToken` (JWT).
      <Tabs>
        <TabItem value="authResult" label="authResult">
        ```js
        {
          user: {
            email: "john.doe@example.com",
            emailVerified: true,
            givenName: "John",
            name: "John Doe",
            id: "usr_74599896446906854"
          },
          idToken: "eyJhbGciO..",
          accessToken: "eyJhbGciOi..",
          refreshToken: "rt_8f7d6e5c4b3a2d1e0f9g8h7i6j..",
          expiresIn: 299
        }
        ```
        </TabItem>
        <TabItem value="idToken" label="ID token (decoded)">
        ```json
        {
          "at_hash": "ec_jU2ZKpFelCKLTRWiRsg",
          "aud": [
            "skc_58327482062864390"
          ],
          "azp": "skc_58327482062864390",
          "c_hash": "6wMreK9kWQQY6O5R0CiiYg",
          "client_id": "skc_58327482062864390",
          "email": "john.doe@example.com",
          "email_verified": true,
          "exp": 1742975822,
          "family_name": "Doe",
          "given_name": "John",
          "iat": 1742974022,
          "iss": "https://scalekit-z44iroqaaada-dev.scalekit.cloud",
          "name": "John Doe",
          "oid": "org_59615193906282635",
          "sid": "ses_65274187031249433",
          "sub": "usr_63261014140912135"
        }
        ```
        </TabItem>
      </Tabs>

      You can [decode the `idToken`](https://authplay.io/pg/token-explorer) to access user information like email, name, and profile verification status directly from the token claims.

4. ## Create a session and log in the user
      You have successfully verified the user's identity and retrieved their profile information. Maintain this authenticated state by creating a session and storing the session tokens (specifically the `accessToken` and `refreshToken`).

      Enable the session option to retrieve the session tokens from the `authResult` object. This allows for setting `accessToken` as HTTP-only cookies and verify authentication state across multiple requests.

      ```javascript ins={1,3}
      import cookieParser from 'cookie-parser';
      // Set cookie parser middleware
      app.use(cookieParser());

      // encrypt the accessToken using a secure encryption algorithm
      const encryptedAccessToken = encrypt(authResult.accessToken);

      // setting up accessToken as HTTP-only cookie
      res.cookie('accessToken', encryptedAccessToken, {
        maxAge: (authResult.expiresIn - 60) * 1000,
        httpOnly: true,
        secure: true,
        path: '/',
        sameSite: 'strict'
      });

      // Store the refreshToken in a secure place
      ```

      This sets browser cookies with the session tokens. Every request to your backend needs to verify the `accessToken` to ensure the user is authenticated. If expired, use the `refreshToken` to get a new access token.

      <Tabs syncKey="tech-stack">
        <TabItem value="node" label="Node.js">
        ```javascript
        // Middleware to verify and refresh tokens if needed
        const verifyToken = async (req, res, next) => {
          try {
            // Get access token from cookie
            const accessToken = req.cookies.accessToken;

            // Decrypt the accessToken using the same encryption algorithm
            const decryptedAccessToken = decrypt(accessToken);

            if (!accessToken) {
              return res.status(401).json({ message: 'No access token provided' });
            }

            // Use Scalekit SDK to validate the token
            const isValid = await scalekit.validateAccessToken(decryptedAccessToken);

            if (!isValid) {
              // Use stored refreshToken to get a new access token
               const {
                    user,
                    idToken,
                    accessToken,
                    refreshToken: newRefreshToken,
              } = await scalekit.refreshToken(refreshToken);

              // Store the new refresh token
              // Update the cookie with the new access token
            }
            next();
        };

        // Example of using the middleware to protect routes
        app.get('/dashboard', verifyToken, (req, res) => {
          // The user object is now available in req.user
          res.json({
            message: 'This is a protected route',
            user: req.user
          });
        });
        ```
        </TabItem>
      </Tabs>

      Successfully authenticated users can now access your dashboard.

</Steps>

## What's next?

You've completed the Scalekit quickstart and enabled secure authentication for your users and sign-in flow.
- [Manage users](/guides/fsa/user-sessions/) to create, update, and delete user accounts.
- [Customize the login page](https://www.example.org) to match your brand's design and style.